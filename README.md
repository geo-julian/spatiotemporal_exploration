# Spatio-Temporal Exploration 

Code repository for [**Predicting the emplacement of Cordilleran porphyry copper systems using a spatio-temporal machine learning model.**](https://authors.elsevier.com/sd/article/S0169-1368(21)00326-7)

Authors:

[Julian Diaz Rodriguez](https://github.com/geo-julian) (corresponding author julian.diazrodriguez@sydney.edu.au) (1)

[Dietmar Muller](https://github.com/dietmarmuller) (1)

[Rohitash Chandra](https://github.com/rohitash-chandra) (2,3)

*(1) EarthByte Group, School of Geosciences, University of Sydney, Sydney, New South Wales, Australia*

*(2) School of Mathematics and Statistics, University of New South Wales, Sydney, Australia.*

*(3) Data Analytics for Resources and Environments, Australian Research Council - Industrial Transformation Training Centre, Australia*

J.  Diaz-Rodriguez,  R.  Dietmar  Müller,  R.  Chandra,  Predicting  the  emplacement  ofCordilleran  porphyry  copper  systems  using  a  spatio-temporal  machine  learning  model, Ore  Geology  Reviews(2021), doi: [https://doi.org/10.1016/j.oregeorev.2021.104300](https://www.sciencedirect.com/science/article/pii/S0169136821003267?via%3Dihub)

## Abstract
Porphyry copper (Cu) systems occur along magmatic belts derived in subduction zones. Our current understanding of their formation is restricted to observations from the overriding plate, resulting in a knowledge gap in terms of processes occurring in convergence zones through time. An association between key tectonic processes and the timing and location of porphyry Cu systems requires linking geological observations to plate tectonic subduction models. We connect the evolution of subduction zones and downgoing slab properties with the history of porphyry ore deposition across the Americas by using a spatio-temporal machine learning approach. We use these spatio-temporal properties to apply a wide range of prominent machine learning methods and show the results in terms of accuracy of predictions on the test dataset. We then provide spatial visualisations in deep-time showing highly prospective areas for porphyry Cu mineralisation along areas not related with known mineral occurrences along the subduction margins of North and South America. We show that a high orthogonal plate convergence speed is the most important feature related to the formation of porphyry Cu systems. This parameter is linked with the thickening of continental arcs which has been shown to enhance Cu transport within plutons. Convergence speed also controls the volume of plate material subducted into the upper mantle, including carbonate phases in the upper volcanic portion of the ocean crust and water-rich pelagic deep sea sediments, which have been demonstrated to enhance sulphur and metal transport, respectively, boosting metasomatic enrichment of the mantle wedge in volatiles, sulphur, and fluid-mobile large ion lithophile elements (LILE), and promoting the formation of porphyry Cu systems in the overriding plate. We incorporate plate tectonic subduction models with machine learning models for the generation of copper mineralization prediction maps. We demonstrate the potential of this application in global mineral exploration along Cordilleran subduction zones and provide open source code and data with our results.

## Instructions:
This code was implemented using Jupyter notebooks and it is a modified version of the [spatio-temporal-exploration](https://github.com/EarthByte/spatio-temporal-exploration) workflow generated by the [EarthByte Group](https://github.com/EarthByte) at The University of Sydney. 

The folder [python_All_data-NA_SA](https://github.com/geo-julian/spatiotemporal_exploration/tree/main/python_All_data-NA_SA) is including the code used to analyse the evolution of subduction zones and downgoing slab properties with the history of porphyry ore deposition across the Americas

The folder [python_NorthAmerica](https://github.com/geo-julian/spatiotemporal_exploration/tree/main/python_NorthAmerica) is including the code used to apply a wide range of prominent machine learning methods and show the results in terms of accuracy of predictions on the test dataset of North America.

The folder [python_SouthAmerica](https://github.com/geo-julian/spatiotemporal_exploration/tree/main/python_SouthAmerica) is including the code used to apply a wide range of prominent machine learning methods and show the results in terms of accuracy of predictions on the test dataset of South America.

## Gridded Input Data
The present location of these porphyry Cu systems and non-prospective rocks is connected with the tectonic properties presented in the convergence zone and the downgoing plate at the time these geological features were formed using the absolute plate motion global model and a new set of oceanic paleo-age grids developed in 1 million years intervals developed by [Müller et al. (2016)](https://www.earthbyte.org/webdav/ftp/Data_Collections/Muller_Dutkiewicz_2018_SciAdv/Supplementary_grids/age_grids_AREPS2016/).


Additionally, this work also incorporates the time-dependent grids developed by [Dutkiewicz et al. (2018)](https://www.earthbyte.org/webdav/ftp/Data_Collections/Dutkiewicz_etal_2019_Geology/carbonate_sediment_thickness_grids/) which models the amount of carbonates present in deep-sea sediments since 170 Ma (there were no deep-sea carbonate sediments before this time) based on global carbonate compensation depth models, carbonate sedimentation rates and paleobathymetry. This work is also using the grids generated by [Müller and Dutkiewicz (2018)](https://www.earthbyte.org/webdav/ftp/Data_Collections/Muller_Dutkiewicz_2018_SciAdv/Supplementary_grids/oceanic_crustal_C02_grids/) which record the percentage of carbon storage in oceanic crust due degassing of CO2 in mid-ocean ridges since 230 Ma. Finally, it has also been incorporated here the grids from [Dutkiewicz et al. (2017)](https://www.earthbyte.org/webdav/ftp/Data_Collections/Dutkiewicz_etal_2017_G3/sediment_thickness_grids/) which models deep sea sediment thickness based on a regression algorithm using sea floor age, mean distance to nearest passive margins and long-term decompacted sedimentation. These three grids are based in the ocean crust paleo-age grid model generated by [Müller et al. (2016)](https://www.earthbyte.org/webdav/ftp/Data_Collections/Muller_Dutkiewicz_2018_SciAdv/Supplementary_grids/age_grids_AREPS2016/).

## Datasets ([link](https://github.com/geo-julian/spatiotemporal_exploration/tree/main/python_All_data-NA_SA/input_data)):

### Dataset for porphyry Cu system:

The selection of the geological features suitable for this work is limited to the identification of porphyry Cu systems formed in calc-alkaline arcs associated with subduction zones recorded in the geological history of the western Cordillera in North America, and the Andes in South America. 

For North America ([NA_positives](https://github.com/geo-julian/spatiotemporal_exploration/blob/main/python_All_data-NA_SA/input_data/NA_positives.csv)), data has been extracted from repositories such as the Mineral Resources Data System from the United States Geological Survey (USGS), and the mineral inventories from the British Columbia and Yukon Geological Surveys. Other sources used include: British Columbia Ministry of Energy, 2020; Hart, 1997; Logan & Mihalynuk, 2014; Long et al., 1998; Nelson et al., 2013; Nixon et al., 2019; Sillitoe et al., 2013; Singer et al., 2005; U.S. Geological Survey, 2020; Yukon Geological Survey, 2020.

For South America ([SA_positives](https://github.com/geo-julian/spatiotemporal_exploration/blob/main/python_All_data-NA_SA/input_data/SA_positives.csv)), we use the same one hundred and fifty-five deposits used by [Butterworth et al. (2016)](https://agupubs.onlinelibrary.wiley.com/doi/full/10.1002/2016TC004289) based on the compilation made by Bertrand et al. (2014), Singer et al. (2008) and Billa et al. (2004) in South America.

### Dataset for non-prospective rocks:

We create this dataset based in the criteria defined by Loucks (2014) to separate prospective from un-prospective magmatic suites. For the case of North America ([NA_negatives](https://github.com/geo-julian/spatiotemporal_exploration/blob/main/python_All_data-NA_SA/input_data/NA_negatives.csv)), Loucks (2014) describes Neogene and Quaternary volcanic and hypabyssal tholeiitic and calc-alkaline suites from the Aleutian arc in Alaska in between 153W and 175W, as not very prospective for porphyry Cu systems. For this work, we selected from the [GEOROC](http://georoc.mpch-mainz.gwdg.de/georoc/) database all samples described as “volcanic” located in the Alaska Peninsula and the Aleutian Islands within the same longitudes and age range described above. 
For South America ([SA_negatives](https://github.com/geo-julian/spatiotemporal_exploration/blob/main/python_All_data-NA_SA/input_data/SA_negatives.csv)), Loucks (2014) selects all the volcanic rocks and shallow intrusive bodies of Neogene and Quaternary age and located between 21.2S and 25.7S or 35S and 46S in the latitude. In this paper, we select any sample described as “volcanic” from the GEOROC database in South America and within the same latitude distribution and age interval as used by Loucks (2014).

## Predictions and Results

[GPlates](www.gplates.org) was used to generate the subduction convergence kinematics [statistics](https://github.com/geo-julian/spatiotemporal_exploration/tree/main/python_All_data-NA_SA/case_AREPS/coreg_output) based on the absolute plate motion global model generated by [Müller et al., 2018](https://agupubs.onlinelibrary.wiley.com/doi/full/10.1029/2018GC007584).

The predictions generated by several machine leaning-based classifiers can be founded here for [North America](https://github.com/geo-julian/spatiotemporal_exploration/tree/main/python_All_data-NA_SA/case_AREPS/ml_output/NA) and [South America](https://github.com/geo-julian/spatiotemporal_exploration/tree/main/python_All_data-NA_SA/case_AREPS/ml_output/SA).

The charts, histograms and reconstructed latitude vs. age of formation figures were created using [IoGAs software](https://reflexnow.com/product/iogas/) with their related [IoGAS_files](https://github.com/geo-julian/spatiotemporal_exploration/tree/main/python/IoGAS_files) 

Maps were created using [ArcMap](https://desktop.arcgis.com/en/arcmap/) and the information is in [ArcMap_files](https://github.com/geo-julian/spatiotemporal_exploration/tree/main/python/ArcMap_files) containing packages (mpk extension) for all the prospectivity maps for North America and South America.

## Acknowledgements

We thank [Dr. Daniel Müller](https://www.researchgate.net/profile/Daniel-Mueller-44) and three anonymous reviewers for their helpful comments on earlier drafts of the manuscript. We thank [Dr. Sara Moron](https://www.linkedin.com/in/sara-mor%C3%B3n-18a25a73/) for her suggestions and support while drafting the manuscript. We thank [Dr. Nathan Butterworth](https://www.linkedin.com/in/nathaniel-butterworth-72003877/) for his support in early stages of this research. We thank [Mrs. Ana Juliana Villa](https://www.linkedin.com/in/ana-villa/) for her support in developing the figures. Finally, we thank [Mr. Danial Azam](https://github.com/Dazaman) and [Mr. Michael Chin](https://github.com/michaelchin) for their technical assistance.


Access EndNote library [Here](https://github.com/geo-julian/spatiotemporal_exploration/tree/main/EndNote_Library)






 

